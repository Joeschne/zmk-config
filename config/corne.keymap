/*
*
* Copyright (c) 2021 Darryl deHaan
* SPDX-License-Identifier: MIT
*
*/

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>

#define COLEMAK 0
#define NUM 1 // numbers
#define SYM 2 // symbols
#define NAV 3 // navigation
#define MOU 4 // mouse emulation
#define FUN 5 // f-keys
#define MED 6 // media layer
#define BLU 7 // bluetooth control layer

// Home Row Mods
#define HRML(k1, k2, k3, k4) &ht LGUI k1   &ht LALT k2   &ht LCTRL k3   &ht LSHFT k4
#define HRMR(k1, k2, k3, k4) &ht RSFT k1   &ht RCTRL k2   &ht RALT k3   &ht RGUI k4

/ {
    behaviors {
        ht: hold_tap {
            label = "hold_tap";
            compatible = "zmk, behavior-hold-tap";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <220>;
            quick-tap-ms = <150>;
            global-quick-tap;
            bindings = <&kp>, <&kp>;
        }
    };

    conditional_layers {
        compatible = "zmk,conditional-layers";
        tri_layer {
            if-layers = <NUM SYM>;
            then-layer = <BLU>;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        /* ─── DEFAULT (COLEMAK) LAYER ─────────────────────────────────────────────────────────────── */
        default_layer {
            display-name = "COLEMAK";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |      Q      |      W      |      F      |      P      |      B      |       |      J      |      L       |      U      |      Y      |     '|?     |   
                    &kp Q        &kp W          &kp F         &kp P         &kp B                  &kp J         &kp L        &kp U          &kp Y        &kp SQT  
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |      A      |      R      |      S      |      T      |      G      |       |      M      |      N       |      E      |      I      |      O      |
                    HRML(A,         R,            S,            T)         &kp G                &kp M         HRMR(N,           E,            I,            O)
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |      Z      |      X      |      C      |      D      |      V      |       |      K      |      H       |     ,|;     |     .|:     |     -|_     |
                    &kp Z        &kp X          &kp C        &kp D         &kp V                 &kp K         &kp H        &kp COMMA      &kp DOT      &kp MINUS 
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |     DEL     |     BSP     |     TAB     |       |   ENTER     |     SPC      |     ALT     |
                                            &lt MED DEL    &lt NAV BSPC  &lt MOU TAB         &lt SYM ENTER  &lt NUM SPACE  &lt FUN ESC
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── NUMPAD LAYER (Right-Thumb Activation: Active mapping on LEFT half) ─────────────────── */
        num_layer {
            display-name = "NUM";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   BKT   |    7      |    8      |    9      |  -     |       |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |
                 &kp AST      &kp 7      &kp 8      &kp 9      &kp MINUS                &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   ;|:    |    4      |    5      |    6      |   PLUS    |       |   TRNS      | HRMR(N,E,I,O)        |
                  &kp SEMI      &kp 4      &kp 5      &kp 6       &kp PLUS               &kp TRNS     &kp RSFT   &kp RCTRL   &kp RALT   &kp RGUI
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   TRNS    |    1      |    2      |    3      |  EQL     |       |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |
                 &kp TRNS       &kp 1      &kp 2      &kp 3      &kp EQL               &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   .    |   0   |   TRNS    |       |   TRNS    |   TRNS     |   TRNS    |
                                            &kp DOT   &kp 0    &kp TRNS         &kp TRNS   &kp TRNS   &kp TRNS
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── SYMBOLS LAYER (Right-Thumb Activation: Active mapping on LEFT half) ───────────────── */
        sym_layer {
            display-name = "SYM";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |     \      |      /      |      |      |      "      |      '      |       |     `       |      (       |      )      |      ^      |      ~      |   
                  &kp BSLH     &kp FSLH      &kp PIPE       &kp DQT      &kp SQT               &kp GRAVE     &kp LPAR       &kp RPAR     &kp CARET      &kp TILDE  
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |      *     |      -      |      &      |      =      |      @      |       |     _       |      {       |      }      |      ;      |      :      |
                    &kp STAR  &kp MINUS      &kp AMPS        &kp EQUAL     &kp AT              &kp UNDER      &kp LBRC        &kp RBRC     &kp SEMI     &kp COLON
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |     %      |      +      |      !      |      ?      |      #      |       |      $      |       [       |     ]      |      <      |      >      |
                  &kp PRCNT     &kp PLUS     &kp EXCL     &kp QMARK      &kp HASH              &kp DLLR       &kp LBKT        &kp RBKT       &kp LT       &kp GT 
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   TRNS    |   TRNS       |   TRNS      |       |   TRNS       |   TRNS        |   TRNS    |
                                            &kp TRNS        &kp TRNS      &kp TRNS              &kp TRNS      &kp TRNS        &kp TRNS
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── NAVIGATION LAYER (Left-Thumb Activation: Active mapping on RIGHT half) ───────────── */
        nav_layer {
            display-name = "NAV";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    TRNS   |   TRNS    |   TRNS    |   TRNS    |   TRNS    |       |   REDO    |   COPY    |   PASTE    |    CUT    |   UNDO    |
                    &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS            &kp REDO    &kp COPY   &kp PASTE   &kp CUT   &kp UNDO   
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |  HRML(A, R, S, T)                            |    TRNS     |       |     CAPS    |   LEFT     |    DOWN     |   UP    |   RIGHT    |
                    &kp LGUI  &kp LALT   &kp LCTRL   &kp LSHFT    &kp TRNS               &kp CAPS    &kp LEFT   &kp DOWN   &kp UP    &kp RGHT   
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    TRNS   |   TRNS    |   TRNS    |   TRNS    |   TRNS    |       |   INS     |   HOME     |   PGDN    |   PGUP    |   END     |
                    &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS                &kp INS    &kp HOME   &kp PGDN   &kp PGUP   &kp END
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |   TRNS     |   TRNS    |
                                            &kp TRNS   &kp TRNS   &kp TRNS         &kp TRNS   &kp TRNS   &kp TRNS
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── MOUSE LAYER (Left-Thumb Activation: Active mapping on RIGHT half) ───────────────────── */
        mou_layer {
            display-name = "MOU";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    TRNS   |   TRNS    |   TRNS    |   TRNS    |   TRNS    |       |   BTN1    |   BTN2     |   BTN3    |   BTN4    |   BTN5    |
                    &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS                &kp BTN1   &kp BTN2   &kp BTN3   &kp BTN4   &kp BTN5
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |  HRML(A, R, S, T)                               |    TRNS     |       |   TRNS    |    MS_L    |   MS_D     |   MS_U    |   MS_R    |
                    &kp LGUI  &kp LALT   &kp LCTRL   &kp LSHFT    &kp TRNS             &kp TRNS       &kp MS_L   &kp MS_D       &kp MS_U    &kp MS_R   
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    TRNS   |   TRNS    |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |  MS_WH_L   |  MS_WH_D   |  MS_WH_U   |    MS_WH_R   |
                    &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS            &kp TRNS    &kp MS_WH_L   &kp MS_WH_D   &kp MS_WH_U   &kp MS_WH_R   
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   TRNS    |   TRNS    |   TRNS    |       |   RIGHT    |   LEFT     |   MIDDLE    |
                                            &kp TRNS   &kp TRNS   &kp TRNS              &kp BTN2       &kp BTN1    &kp BTN3     
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── MEDIA LAYER (Left-Thumb Activation: Active mapping on RIGHT half) ───────────────────── */
        med_layer {
            display-name = "MED";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    TRNS   |   TRNS    |   TRNS    |   TRNS    |   TRNS    |         |   TRNS    |   TRNS    |   MPLY    |   MUTE    |   TRNS    |
                    &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS              &kp TRNS  &kp TRNS         &kp C_PP     &kp C_MUTE   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |  HRML(A, R, S, T)                              |    TRNS     |        |  TRNS    |   MPRE    |   VOLU    |   VOLD     |   MNXT    |
                    &kp LGUI  &kp LALT   &kp LCTRL   &kp LSHFT    &kp TRNS                &kp TRNS   &kp C_PREV    &kp C_VOL_UP   &kp C_VOL_DN    &kp C_NEXT
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    TRNS   |   TRNS    |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |   TRNS     |   Bright    |   Dark    |   Backlight    |
                    &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS                &kp TRNS   &kp TRNS   &kp C_BRI_UP   &kp C_BRI_DN   &kp C_BKLT_TOG
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   TRNS    |   TRNS    |   TRNS    |       |   Play/Pause    |   MNXT     |   MUTE    |
                                            &kp TRNS   &kp TRNS   &kp TRNS               &kp C_PP   &kp C_NEXT   &kp C_MUTE
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── FUN (F-KEYS) LAYER (Right-Thumb Activation: Active mapping on LEFT half) ─────────── */
        fun_layer {
            display-name = "FUN";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   F12     |  F7      |   F8      |   F9      |  TRNS     |       |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |
                  &kp F12   &kp F7     &kp F8      &kp F9     &kp TRNS                &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   F11     |   F4      |   F5      |   F6      |  TRNS     |       |   TRNS       | HRMR(N,E,I,O)                               |
                  &kp F11   &kp F4     &kp F5     &kp F6       &kp TRNS               &kp TRNS      &kp RSFT   &kp RCTRL   &kp RALT   &kp RGUI
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |    F10    |   F1      |   F2      |   F3    |    TRNS     |       |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |
                  &kp F10   &kp F1     &kp F2     &kp F3     &kp TRNS               &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |   TRNS     |   TRNS    |
                                            &kp TRNS   &kp TRNS   &kp TRNS         &kp TRNS   &kp TRNS   &kp TRNS
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

        /* ─── BLUETOOTH LAYER (Right-Thumb Activation: Active mapping on LEFT half) ────────────── */
        blu_layer {
            display-name = "BLU";
                        bindings = <

            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |
                    &bt BT_DISC 0   &bt BT_DISC 1   &bt BT_DISC 2   &bt BT_DISC 3   &bt BT_DISC 4               &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |       |   M       | HRMR(N,E,I,O)                                  |
                    &kp TRNS   &kp TRNS  &kp TRNS   &kp TRNS   &bt BT_CLR               &kp M      &kp RSFT   &kp RCTRL   &kp RALT   &kp RGUI
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            // |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |   TRNS     |   TRNS    |   TRNS    |   TRNS    |
                    &bt BT_SEL 0   &bt BT_SEL 1   &bt BT_SEL 2   &kp BT_SEL 3   &bt BT_SEL 4             &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS   &kp TRNS
            // |----------------------------------------------------------------------------------------------------------------------------------------------------|
            //                             |   TRNS    |   TRNS    |   TRNS    |       |   TRNS    |   TRNS     |   TRNS    |
                                            &kp TRNS   &kp TRNS   &kp TRNS         &kp TRNS   &kp TRNS   &kp TRNS
            //                             |-------------|-------------|-------------|-------|-------------|--------------|-------------|
                        >;
        };

    };
};
